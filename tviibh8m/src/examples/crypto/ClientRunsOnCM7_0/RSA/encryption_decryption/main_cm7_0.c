/***************************************************************************//**
* \file main_cm7_0.c
*
* \version 1.0
*
* \brief Main example file for CM7_0
*
********************************************************************************
* \copyright
* Copyright 2016-2020, Cypress Semiconductor Corporation. All rights reserved.
* You may use this file only in accordance with the license, terms, conditions,
* disclaimers, and limitations in the end user license agreement accompanying
* the software package with which this file was provided.
*******************************************************************************/

#include "cy_project.h"
#include "cy_device_headers.h"

/* Include default crypto configuration.
 * You can use other configuration instead follows.
 */
#include "crypto/cy_crypto_config.h"

#define RSA_KEY_LENGTH_1024BIT (1024ul)
#define RSA_KEY_LENGTH_2048BIT (2048ul)
#define RSA_KEY_LENGTH_3072BIT (3072ul)
#define RSA_KEY_LENGTH_IN_BIT  RSA_KEY_LENGTH_1024BIT
/* For CRYPTO client that can run on the both CPUs */
cy_stc_crypto_context_t        cryptoCtx;

/* Test vector */
uint8_t modulus[] = 
{
/* This is a modulus. (a part of public key)
 * Refer public_key.txt
 */
/* Big endian format */
#if RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_1024BIT
    0xc5,0x98,0xb6,0xe7,0xb8,0x02,0x87,0x90,0xfa,0x77,0x75,0x1e,0xcf,0x55,0x30,0x8a,
    0xd0,0x73,0x46,0x3e,0x97,0x23,0x89,0xf1,0xc2,0x22,0xdb,0xa9,0xf5,0x99,0xeb,0xd5,
    0x88,0xbf,0x2a,0x87,0x74,0x89,0xc9,0x79,0x52,0x37,0xd1,0x33,0x86,0xce,0x82,0x3f,
    0xc4,0x06,0x91,0x42,0x0f,0x91,0x09,0x17,0xb8,0x41,0xd0,0x47,0x5f,0xfe,0xaf,0x34,
    0x51,0x68,0xd4,0xbe,0x4a,0xc7,0x6c,0xd7,0x43,0xe5,0xa6,0x21,0x4e,0xab,0x4f,0x9e,
    0x05,0x72,0x9a,0x9a,0x02,0xc1,0x0e,0x78,0x72,0x53,0x90,0x65,0x93,0x90,0x49,0x67,
    0x3f,0x21,0xc4,0x0e,0x4b,0xf2,0xdc,0xf0,0x8f,0xd3,0x09,0x6f,0x0c,0xc9,0x91,0x6e,
    0xbf,0xfb,0xac,0x76,0x45,0xf4,0xf3,0x48,0xb1,0xf4,0x33,0x0b,0xde,0x75,0x90,0xf9,
#elif RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_2048BIT
    0x9f,0x00,0x32,0x24,0x41,0x9d,0x4d,0x77,0x7e,0x8b,0x55,0xb9,0x54,0x8e,0xa8,0x9e,
    0xdd,0x98,0x22,0xdc,0xe6,0xcd,0x34,0xb1,0x47,0xba,0xa7,0xeb,0xd8,0xfd,0x3b,0x6b,
    0x4e,0x34,0x7e,0xe3,0x4f,0x82,0x84,0x2c,0x3d,0x9c,0x00,0x67,0x52,0x60,0xc6,0x63,
    0xb8,0xc9,0x2a,0xf7,0x8b,0x09,0xfd,0x81,0x78,0x3a,0xb5,0x5e,0x46,0xe4,0x74,0xa5,
    0x24,0x57,0x7f,0x04,0x52,0xda,0xb5,0xa8,0x46,0x45,0x29,0xf7,0x47,0x3a,0xd5,0x4c,
    0xeb,0xae,0x7e,0x14,0x90,0x23,0xf3,0xa8,0x5d,0x91,0xca,0xce,0xa4,0x20,0xb3,0x78,
    0xfd,0x0c,0x3a,0x1f,0x97,0x46,0x09,0x92,0x19,0x02,0x6d,0xfb,0xf5,0x65,0x28,0xeb,
    0x8d,0x80,0x2d,0x98,0x6a,0xcb,0x51,0xf0,0xfc,0x25,0x74,0x66,0x79,0x19,0xea,0xdb,
    0xee,0xa4,0xfe,0xb5,0xe6,0x25,0x6f,0xff,0x56,0x07,0x77,0xdb,0xb8,0xfb,0x71,0xd8,
    0xa9,0xe7,0x19,0x70,0xc0,0x81,0x4b,0xf1,0x4f,0xa3,0xf7,0x3e,0x75,0x15,0x63,0x72,
    0x95,0x5b,0x11,0xe3,0x2d,0xcd,0x47,0x99,0xea,0x23,0x63,0x54,0xcf,0x52,0x0e,0x2a,
    0xc0,0xc2,0xfd,0x55,0x2b,0xbc,0xed,0xc8,0xee,0x33,0xc9,0xe5,0x46,0xef,0xf0,0x0a,
    0x7d,0xf9,0x66,0x43,0x41,0x00,0x19,0xbd,0xc6,0x87,0x2e,0x95,0x88,0x2d,0x38,0x23,
    0xa2,0x37,0xbe,0x84,0xb4,0x6a,0xda,0x9b,0xac,0x7c,0x58,0xf5,0xf9,0xe6,0xc8,0x05,
    0xb0,0x20,0x1c,0xfb,0xee,0x26,0xf6,0xf3,0x09,0xa2,0x67,0xe9,0xff,0x02,0x93,0x60,
    0x3e,0x31,0x73,0xb6,0x9a,0x0b,0x34,0xd6,0x76,0x48,0xeb,0xa5,0x94,0x7d,0xc2,0x89,
#else // RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_3072BIT
    0xc0,0x37,0x04,0x94,0xa6,0x65,0xb9,0x61,0x7d,0xeb,0xf7,0x36,0xeb,0x9a,0x4f,0x82,
    0x4a,0xce,0xc5,0xc6,0x1e,0xbe,0x1e,0x19,0x1a,0x71,0xac,0xaf,0x7f,0x05,0x75,0xf5,
    0x31,0xb9,0x25,0x04,0xb6,0x7e,0xfd,0x1f,0x84,0x72,0xbf,0x46,0x2e,0x53,0x3a,0x98,
    0x71,0xb0,0xf2,0xb7,0x95,0xe7,0x15,0x0b,0x60,0x7c,0x94,0xb7,0xd5,0xd1,0x7d,0x74,
    0x96,0x77,0xe2,0x5f,0xf2,0xaa,0xc3,0xfd,0xcc,0x30,0x55,0x24,0x84,0xc2,0x3d,0xba,
    0x07,0x2a,0x05,0xc3,0xdf,0x26,0xf5,0xb5,0x40,0xdf,0x99,0x99,0xe2,0x2e,0x17,0x13,
    0x19,0x4b,0xcc,0x8f,0x2a,0x02,0x1e,0x4f,0x90,0x9b,0x3d,0x85,0x66,0xc5,0xa3,0x1d,
    0x37,0x85,0xc7,0x8a,0xc3,0x30,0xf4,0x04,0x81,0x87,0xcf,0xbe,0x5b,0x54,0x1f,0xf7,
    0x62,0x72,0xcc,0x1a,0xa2,0xf9,0x92,0x1a,0x99,0xae,0x3e,0x61,0xb5,0x93,0xa4,0x71,
    0x79,0xb7,0xbc,0x2a,0x28,0x3a,0x34,0x17,0x46,0x24,0xb1,0x8a,0x21,0x55,0x7f,0x61,
    0xe8,0xca,0x93,0xbf,0x30,0x28,0x0d,0x48,0xa4,0x16,0xb1,0x71,0x87,0x2d,0xb9,0xe0,
    0x0a,0x5f,0xa8,0xf1,0x34,0xb8,0x8e,0x98,0x50,0x7c,0x20,0x6c,0x38,0x05,0x25,0xc8,
    0xca,0x0a,0x5d,0xc8,0x6d,0x74,0x4c,0xd9,0x1e,0x05,0x82,0xb1,0xad,0xe0,0x9c,0xf4,
    0x2b,0xb2,0xf4,0x34,0x3a,0x5e,0xd4,0xbc,0x36,0x8a,0xda,0xa4,0x11,0x1d,0x9c,0xc6,
    0xee,0xf7,0x52,0x56,0x23,0x93,0xd9,0x95,0x3d,0x61,0xa8,0x59,0xba,0x8e,0x46,0xa0,
    0x3f,0x1f,0x44,0xa9,0x06,0xb2,0x74,0xb4,0x46,0x44,0xb4,0x94,0xb0,0xa1,0xa8,0x9f,
    0x7e,0xe1,0x08,0x99,0x85,0x57,0x86,0x18,0x62,0xc2,0xcf,0x23,0x1d,0xd1,0x60,0x0a,
    0xbb,0x8f,0x4a,0x48,0xc6,0x83,0x8f,0xbd,0x94,0x6e,0xc2,0x70,0x86,0xb7,0xb8,0xb8,
    0x4a,0x3c,0xc1,0xd1,0x40,0xc6,0x81,0x98,0x9c,0x63,0xa9,0x82,0x0e,0x6e,0xe8,0xb4,
    0x5f,0x48,0xf9,0x34,0x7e,0x06,0x88,0x8e,0x2c,0x9d,0xcc,0x72,0x27,0x4f,0xe8,0xa7,
    0xe3,0x1d,0xdf,0x5c,0x60,0xda,0x75,0x4a,0xa1,0x04,0xcb,0xee,0x00,0x87,0x6e,0x4b,
    0x3b,0xd4,0x90,0x12,0x53,0xad,0xc0,0x80,0x43,0xaf,0x61,0x16,0xe8,0x6e,0xd2,0x9e,
    0xcc,0xd5,0xe3,0xb2,0x01,0xe9,0xdc,0x02,0x51,0x8c,0x24,0x03,0xe5,0xb8,0x81,0xc1,
    0xf2,0x13,0xea,0xea,0x8c,0x27,0xd0,0x98,0x5f,0x9a,0x83,0x11,0x2a,0x84,0x4c,0x19,
#endif
};

uint8_t privateExponent[] = 
{
/* This is private key. (So called d)
 * Refer private_key.txt
 */
/* Big endien format */
#if RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_1024BIT
    0x9a,0xb1,0x4b,0x08,0x2f,0x93,0xb3,0x64,0x39,0xe1,0xc9,0x8c,0x3c,0x4e,0xfa,0x38,
    0xc2,0xa6,0x6c,0x68,0xd5,0xd4,0x19,0xcb,0x6d,0xeb,0xf2,0x42,0xa5,0xa7,0x41,0xed,
    0x23,0x28,0x5d,0xf8,0x3b,0xb1,0x1f,0x4c,0xde,0xa4,0x1a,0x20,0x97,0xba,0x16,0x58,
    0x2b,0x73,0xe4,0xc6,0x6d,0xff,0x62,0xb9,0xf2,0x23,0x7c,0x16,0x54,0xbd,0xc3,0x94,
    0xf6,0xa3,0x71,0x27,0xc6,0xb7,0xc2,0x23,0xd5,0x75,0xc1,0xeb,0xc1,0xfd,0x36,0x61,
    0x9e,0x37,0xe1,0x86,0xb6,0x1e,0xe5,0x8b,0x0c,0xe7,0xd0,0x7e,0x95,0x34,0x46,0x0c,
    0xb2,0x11,0x3f,0xe0,0x23,0xa6,0x55,0x3d,0x1b,0xdd,0xc9,0x04,0x7f,0x3e,0x47,0x69,
    0x9b,0x8b,0x05,0xa8,0x57,0xec,0x0a,0xe6,0x66,0x04,0x77,0xec,0x74,0x0e,0xe5,0x81,
#elif RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_2048BIT
    0x1d,0x65,0x17,0xe0,0x04,0x11,0x64,0xc4,0xf6,0xac,0x23,0xc9,0x03,0x8c,0xec,0x37,
    0x92,0x98,0x11,0xb9,0xed,0x21,0x7a,0xe0,0x5b,0x76,0x72,0x9c,0xf3,0x9c,0xbd,0x63,
    0x75,0x2d,0xd7,0x57,0x86,0xd7,0x86,0x3f,0xf7,0x93,0xe3,0xaf,0x36,0x57,0x95,0xd5,
    0xd1,0xcf,0xbf,0x15,0xcc,0xaa,0xa8,0x27,0x4b,0x66,0xef,0x28,0xe2,0xca,0x51,0x96,
    0x46,0x45,0xb6,0xc1,0xc1,0xdf,0x95,0x3d,0xea,0xdf,0xd6,0x86,0x54,0xb0,0xd7,0xc6,
    0x44,0xbc,0x19,0xab,0x0b,0x8a,0xd9,0xfd,0x02,0x6f,0x75,0xa3,0x06,0x4c,0xd5,0x61,
    0x44,0xc7,0x01,0xe7,0xdd,0x3b,0xa1,0x81,0x55,0x06,0x51,0xf7,0x06,0xc3,0x10,0xf1,
    0x9b,0x53,0x5b,0x1a,0x96,0x83,0xc8,0x3e,0x59,0x1f,0x43,0x89,0xbe,0x51,0xc0,0x4d,
    0x66,0x0b,0x0a,0x09,0x62,0xc4,0xf4,0xe6,0x8c,0xc1,0x72,0x73,0x48,0x40,0x17,0xbc,
    0x28,0x3a,0x23,0x23,0xf5,0xa0,0xdc,0xc4,0x8e,0xbe,0x79,0xbe,0x84,0x04,0x0c,0x5f,
    0x5d,0x31,0xfa,0xff,0x4c,0x63,0xc1,0x64,0x22,0xa4,0xd8,0x22,0x2f,0x2b,0x08,0x87,
    0x3e,0x05,0x13,0x73,0x58,0x4c,0xdb,0xf3,0x67,0x29,0xda,0xce,0x6b,0x63,0x97,0x54,
    0x62,0x6c,0x09,0x91,0xd0,0x89,0x4e,0xfe,0x2b,0x06,0x09,0xe0,0xbf,0x32,0xea,0x7d,
    0x60,0x72,0x13,0x0d,0x36,0x73,0x9f,0xa7,0x5f,0xd8,0x42,0xfd,0x4e,0x36,0xea,0x4d,
    0x9e,0x62,0xfc,0xf4,0x73,0xcd,0x2d,0x44,0x8d,0x6c,0x65,0x20,0x3e,0x61,0xda,0x33,
    0xd3,0xdf,0x8b,0x18,0x2a,0xd4,0x03,0x63,0xfc,0x57,0x32,0x36,0x60,0x0a,0x89,0x41,
#else // RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_3072BIT
    0xb9,0xda,0x78,0xcb,0x62,0xb9,0x29,0x2e,0x63,0x1b,0x2d,0xc6,0x24,0xb8,0xe7,0xf8,
    0x0b,0x6d,0x33,0x3e,0x05,0xab,0xbe,0x5e,0x77,0x7b,0x42,0x85,0xce,0x43,0xf1,0x72,
    0x4b,0xc9,0xc1,0x49,0x75,0x4c,0x04,0x63,0xdd,0x25,0x36,0x5d,0x1d,0x9d,0xcc,0x22,
    0x6a,0x8b,0xb5,0xa4,0x5d,0x85,0x3a,0x8b,0xed,0x97,0x88,0x14,0xd8,0xe1,0xde,0x74,
    0x44,0xa9,0x56,0x71,0x7f,0xaa,0x2e,0x27,0xd0,0xaf,0x4b,0x24,0x2c,0x59,0xc4,0x65,
    0x83,0x57,0xd6,0x8b,0x35,0xd1,0xed,0xf2,0x7b,0xef,0xb8,0x0d,0x5a,0xed,0x45,0xd2,
    0x69,0xbb,0x28,0xe7,0xa4,0xae,0xb7,0xb0,0x27,0x1a,0x73,0xb9,0xf1,0x4d,0x58,0x12,
    0x80,0x05,0x12,0x93,0xd1,0x78,0x1b,0xf9,0xdf,0x64,0xfa,0x32,0x0d,0x0c,0xa2,0x7c,
    0x08,0xed,0x06,0xfd,0x1a,0x68,0x46,0x25,0x02,0x43,0xc0,0x7d,0xa9,0x9c,0x40,0x7c,
    0x98,0x3c,0x57,0xec,0x4b,0x49,0x3b,0xe4,0xe5,0x25,0xc5,0xa4,0xd1,0xe6,0x61,0x6c,
    0xc2,0x32,0x5d,0xf9,0x97,0x0e,0xa3,0x09,0x81,0xdf,0x8f,0x63,0x3e,0x59,0xb0,0x48,
    0x38,0xbf,0x96,0x12,0xe3,0xef,0x2f,0xb1,0x86,0xe0,0xfe,0x58,0xa5,0x32,0x14,0xfd,
    0x09,0x75,0xbf,0xbc,0xaf,0x41,0x5d,0x84,0xcc,0xa9,0xd2,0x46,0xb9,0x7f,0xf4,0xc3,
    0x6f,0xb2,0x40,0x87,0x39,0x94,0x27,0x01,0xc5,0xa0,0x66,0xfa,0xd7,0x2a,0x6d,0xac,
    0x07,0x26,0x43,0xf1,0x50,0x0e,0x02,0xc1,0xec,0xd9,0x3a,0xe3,0x9f,0x16,0x1c,0xf9,
    0x20,0x5b,0xd9,0x47,0x8a,0xda,0x05,0xd2,0x04,0xa6,0x50,0x20,0x01,0x2f,0xd0,0x58,
    0xc1,0xc0,0x75,0x1d,0x6e,0xd0,0x62,0xcf,0x65,0xd1,0xc0,0x23,0xc5,0xf9,0x7f,0xaa,
    0x77,0xf0,0x77,0x9c,0xab,0xa6,0x66,0xa5,0x58,0xbd,0xf7,0x8a,0x39,0xec,0x83,0x22,
    0xff,0x0f,0x26,0x2b,0xf0,0x93,0x98,0x42,0x51,0xa1,0xb1,0xdb,0xfd,0xa9,0xe2,0x74,
    0xa1,0xed,0xc0,0xfc,0x88,0x3a,0xea,0x5c,0x12,0x8c,0xb6,0xe5,0x3f,0x69,0x88,0xdb,
    0x90,0x07,0x28,0x9d,0x4f,0x88,0x21,0x39,0x72,0x6f,0xbb,0x7a,0x4c,0xca,0x3f,0x34,
    0xc7,0x99,0x6e,0x51,0x15,0x52,0x8a,0x02,0x46,0x8e,0x6e,0x2e,0x11,0xde,0x77,0xdd,
    0xef,0x92,0x04,0xfd,0xb0,0x76,0xa0,0x39,0x24,0x32,0x82,0x42,0x41,0x69,0x52,0xc8,
    0xbd,0xf8,0xf1,0xfa,0xf6,0x87,0x27,0xaa,0x06,0x39,0x15,0x0d,0x15,0x17,0x87,0xa1,
#endif
};

uint8_t publicExponent[] = 
{
/* This is a part of public key. (So called e)
 * Refer public_key.txt
 */
/* Big endien format */
    0x01, 0x00, 0x01
};

uint8_t cipherTxt[] = 
{
/* This value is calculated from
 * public_key.pem and plain_text.txt without any padding.
 * You can calculate the value if using OpenSSL:
 *  openssl rsautl -encrypt -pubin -inkey public_key.pem -in plain_text.txt -raw -out encrypted_with_publickey.encrypted
*/
/* Big endien format */
#if RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_1024BIT
    0xA9,0x51,0xE4,0x0D,0xD8,0x2C,0x7A,0xB7,0x06,0xB7,0x50,0x3C,0xC3,0xBB,0x59,0x3F,
    0x64,0x71,0xA0,0x7C,0x36,0xD2,0x18,0x57,0xA2,0xD2,0xB1,0xBE,0x0C,0x40,0x58,0x2C,
    0x55,0xE4,0xFB,0xDD,0x5C,0x0D,0xB3,0x23,0x5B,0x47,0x4C,0xD1,0x17,0x2C,0xCC,0xB4,
    0xB1,0x85,0x4A,0x73,0x99,0xBA,0x53,0x20,0xF4,0xD6,0xFE,0xED,0x2C,0x8F,0xB9,0xB7,
    0x7B,0x9A,0xCE,0x48,0xE6,0x46,0x71,0x06,0xF4,0xC6,0xFA,0xD6,0x03,0xE3,0x24,0x5E,
    0x46,0x7D,0x14,0x83,0x9D,0x5B,0x54,0x89,0x63,0x70,0xD7,0x12,0x89,0x5E,0xD9,0xD4,
    0x36,0xE4,0x4F,0x8D,0x1A,0xF9,0xF0,0xD5,0x3E,0x96,0xD9,0x3C,0x51,0x69,0x65,0xE5,
    0xE7,0xA3,0xAB,0xE5,0xBD,0xBA,0x69,0x2F,0xD3,0xB5,0xA9,0xD6,0x9E,0xE6,0xCE,0xF5,
#elif RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_2048BIT
    0x09,0x29,0xD2,0xAB,0x0F,0x02,0x8A,0x09,0x6F,0xE3,0xCA,0xC2,0x45,0x6C,0xBF,0x93,
    0xB1,0x5F,0xC1,0x34,0x45,0xE6,0x79,0xD6,0x78,0xB0,0x56,0x65,0x15,0x7E,0x42,0xBF,
    0x44,0x38,0x20,0x4A,0x11,0x35,0xD2,0x35,0x74,0xD8,0xA0,0x89,0xA6,0x6C,0xC1,0xE6,
    0xA4,0xBE,0xD0,0xF6,0x68,0xA5,0x95,0xE0,0xC5,0x4F,0xDF,0xF8,0xF7,0x7D,0x21,0x41,
    0xDE,0xD0,0x80,0xAD,0x05,0x7B,0x03,0x9D,0x6C,0xB7,0x31,0xBD,0x92,0x3E,0xB6,0x6D,
    0xDF,0x75,0xFF,0x78,0x4A,0x08,0x17,0x6A,0xA0,0x2B,0x97,0xCD,0x60,0x50,0xBB,0x79,
    0x5E,0x06,0xCB,0x77,0xB0,0xA0,0x67,0x3B,0xFF,0x10,0xCD,0xFD,0x3D,0xA3,0x09,0xC5,
    0x1D,0xE0,0xC0,0x41,0xA4,0xA9,0xF3,0x83,0x23,0x9E,0xA7,0xD4,0xAD,0xAC,0xDE,0x2C,
    0x1E,0x4C,0x30,0x95,0x64,0xE0,0x85,0x8D,0x6C,0xF4,0x9F,0xEF,0x30,0xA5,0x4E,0x6D,
    0x91,0x37,0x04,0xC5,0x3B,0xC6,0xA5,0x75,0xED,0x30,0xE8,0xBB,0xA0,0xCD,0x8B,0x49,
    0xAF,0xBC,0x80,0x67,0x34,0x55,0x2C,0x27,0xDC,0x0D,0xDC,0x7C,0x83,0xCE,0xEF,0x70,
    0x2C,0x4D,0xB4,0x45,0x88,0xC2,0xA3,0xC3,0xCA,0xE0,0xB4,0x25,0xC6,0xC9,0xB1,0xBF,
    0x68,0x90,0xFB,0xBD,0x96,0x17,0xCE,0x1B,0xBC,0xF7,0xB4,0x38,0x70,0xFC,0x7B,0xFE,
    0xB9,0x4B,0xF8,0xDB,0x72,0x7A,0x3B,0x74,0x8F,0x88,0xAE,0x33,0x14,0xD1,0x70,0x69,
    0xC7,0x2C,0x26,0xB1,0x63,0x1D,0xD5,0xA0,0x3E,0xB8,0x31,0x0D,0x02,0x18,0xB1,0xF8,
    0x70,0x81,0x20,0x3E,0x7A,0x95,0x23,0x66,0xFA,0x15,0xC4,0x26,0xC1,0x39,0x6A,0xAD,
#else // RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_3072BIT
    0xA4,0x91,0x6E,0x1E,0xD0,0x7E,0xDD,0x32,0x7D,0xE5,0x2B,0xBF,0x1E,0x6C,0xCD,0x15,
    0xAD,0x18,0x50,0xB7,0xC3,0xE2,0x80,0xC2,0x88,0xC7,0x07,0xDB,0x31,0xAD,0x78,0x9F,
    0xA9,0x2C,0x47,0x53,0xA3,0x69,0x3D,0xA3,0xA6,0x9A,0x39,0x43,0x90,0xD4,0x17,0x41,
    0xF0,0x5B,0xC2,0xD4,0x75,0xFE,0x9D,0xBB,0xA8,0x26,0xF0,0x14,0x3C,0x5C,0x38,0xA1,
    0x3E,0xE5,0x26,0x40,0xC7,0x76,0xD5,0x4A,0x23,0x79,0xFE,0x91,0x26,0x49,0x36,0x39,
    0x8F,0x7F,0xDA,0x48,0x70,0xF7,0x00,0xE9,0xD9,0xB9,0x27,0x7A,0x76,0x93,0x2D,0xB3,
    0x84,0x56,0xB8,0x65,0xBB,0xB5,0x27,0x06,0x23,0x0D,0x10,0x22,0xD1,0xDF,0xFD,0x0D,
    0xE1,0xC7,0xAF,0x96,0x7F,0x62,0x5C,0x61,0xB6,0x63,0x2B,0x46,0x30,0x6C,0x5B,0x22,
    0x58,0x66,0x69,0x3E,0x8E,0x27,0x07,0x2B,0x5C,0xC0,0xA2,0xE9,0xAB,0xA7,0x84,0x20,
    0x8F,0x28,0xD7,0x50,0x84,0x45,0xC9,0xBD,0x19,0xDC,0xDF,0x33,0xD9,0x22,0xF0,0xB4,
    0x42,0xDC,0x3C,0x63,0x5A,0xC8,0xF1,0x9E,0x98,0x13,0x34,0x1F,0xE1,0x5A,0x1D,0x00,
    0xA1,0xCE,0x35,0xD2,0x0E,0x6B,0xB3,0xF7,0x1B,0xE3,0xB5,0x74,0x5B,0xB5,0xFA,0x98,
    0x38,0xDF,0xCC,0x48,0x46,0xE2,0xE0,0x71,0x25,0x7F,0x90,0x28,0x2E,0x32,0x17,0xB7,
    0xC8,0xED,0xA5,0x62,0x46,0x11,0x6C,0x7E,0xE7,0x95,0x78,0xB0,0xE3,0xE6,0xC1,0x90,
    0xCD,0x29,0x94,0x88,0x3E,0xB2,0xC2,0x8B,0x78,0xF2,0x6B,0x38,0x52,0xB2,0x63,0x41,
    0x9E,0xCE,0x2F,0x87,0x8F,0x5F,0xFA,0x17,0xF6,0x62,0x62,0x97,0x63,0x6D,0x76,0xD3,
    0x03,0x7F,0x9D,0xDB,0xA9,0x0E,0x7B,0xC1,0x97,0xD2,0xCD,0x81,0x25,0x30,0x87,0x52,
    0x5E,0x3D,0x09,0x8C,0x9B,0xC4,0xE3,0xF1,0x7A,0x56,0x9C,0x19,0x4B,0x7A,0x87,0x77,
    0x06,0x04,0xAD,0x29,0x48,0x0F,0xFB,0x66,0x6C,0x05,0x33,0xE2,0x27,0x65,0x65,0xB4,
    0xB0,0x8C,0x1A,0x8F,0xC7,0x5B,0x52,0xA5,0xBB,0x5D,0x82,0x96,0x65,0x81,0x5E,0x2E,
    0x99,0x38,0xF4,0x2B,0x93,0xE1,0x82,0x77,0x83,0xFC,0x0C,0x2D,0x83,0x5C,0x93,0x96,
    0xDF,0x67,0x4E,0xBC,0xE6,0x0E,0xCA,0x93,0x1E,0x87,0x83,0x1B,0xF5,0xC5,0x74,0xAB,
    0xAD,0x0A,0x07,0x91,0x21,0xB9,0x13,0x5D,0x80,0x91,0x04,0xE0,0x6B,0x46,0x49,0xEC,
    0x41,0x33,0x8F,0xE2,0x50,0xF6,0x7E,0x00,0x0C,0x47,0x74,0x1C,0x89,0x51,0x5A,0x3F,
#endif
};

uint8_t decryptedTxt[RSA_KEY_LENGTH_IN_BIT/8];

/* The plain text that encrypted to cipherTxt (except end of the string \0) */
/* Endianess is also big endian */
#if RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_1024BIT
uint8_t decryptedTxt_ref[] = "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge";
#elif RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_2048BIT
uint8_t decryptedTxt_ref[] = "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge"
                             "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge";
#else // RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_3072BIT
uint8_t decryptedTxt_ref[] = "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge"
                             "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge"
                             "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge";
#endif

/* The plain text. Same as decryptedTxt_ref */
/* Endianess is also big endian */

#if RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_1024BIT
uint8_t plainTxt[] = "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge";
#elif RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_2048BIT
uint8_t plainTxt[] = "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge"
                     "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge";
#else // RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_3072BIT
uint8_t plainTxt[] = "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge"
                     "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge"
                     "hogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehogehoge";
#endif

uint8_t encryptedTxt[RSA_KEY_LENGTH_IN_BIT/8u];

uint8_t encryptedTxt_ref[] = 
{
/* Same as cipherTxt */
/* Big endian format */
#if RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_1024BIT
    0xA9,0x51,0xE4,0x0D,0xD8,0x2C,0x7A,0xB7,0x06,0xB7,0x50,0x3C,0xC3,0xBB,0x59,0x3F,
    0x64,0x71,0xA0,0x7C,0x36,0xD2,0x18,0x57,0xA2,0xD2,0xB1,0xBE,0x0C,0x40,0x58,0x2C,
    0x55,0xE4,0xFB,0xDD,0x5C,0x0D,0xB3,0x23,0x5B,0x47,0x4C,0xD1,0x17,0x2C,0xCC,0xB4,
    0xB1,0x85,0x4A,0x73,0x99,0xBA,0x53,0x20,0xF4,0xD6,0xFE,0xED,0x2C,0x8F,0xB9,0xB7,
    0x7B,0x9A,0xCE,0x48,0xE6,0x46,0x71,0x06,0xF4,0xC6,0xFA,0xD6,0x03,0xE3,0x24,0x5E,
    0x46,0x7D,0x14,0x83,0x9D,0x5B,0x54,0x89,0x63,0x70,0xD7,0x12,0x89,0x5E,0xD9,0xD4,
    0x36,0xE4,0x4F,0x8D,0x1A,0xF9,0xF0,0xD5,0x3E,0x96,0xD9,0x3C,0x51,0x69,0x65,0xE5,
    0xE7,0xA3,0xAB,0xE5,0xBD,0xBA,0x69,0x2F,0xD3,0xB5,0xA9,0xD6,0x9E,0xE6,0xCE,0xF5,
#elif RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_2048BIT
    0x09,0x29,0xD2,0xAB,0x0F,0x02,0x8A,0x09,0x6F,0xE3,0xCA,0xC2,0x45,0x6C,0xBF,0x93,
    0xB1,0x5F,0xC1,0x34,0x45,0xE6,0x79,0xD6,0x78,0xB0,0x56,0x65,0x15,0x7E,0x42,0xBF,
    0x44,0x38,0x20,0x4A,0x11,0x35,0xD2,0x35,0x74,0xD8,0xA0,0x89,0xA6,0x6C,0xC1,0xE6,
    0xA4,0xBE,0xD0,0xF6,0x68,0xA5,0x95,0xE0,0xC5,0x4F,0xDF,0xF8,0xF7,0x7D,0x21,0x41,
    0xDE,0xD0,0x80,0xAD,0x05,0x7B,0x03,0x9D,0x6C,0xB7,0x31,0xBD,0x92,0x3E,0xB6,0x6D,
    0xDF,0x75,0xFF,0x78,0x4A,0x08,0x17,0x6A,0xA0,0x2B,0x97,0xCD,0x60,0x50,0xBB,0x79,
    0x5E,0x06,0xCB,0x77,0xB0,0xA0,0x67,0x3B,0xFF,0x10,0xCD,0xFD,0x3D,0xA3,0x09,0xC5,
    0x1D,0xE0,0xC0,0x41,0xA4,0xA9,0xF3,0x83,0x23,0x9E,0xA7,0xD4,0xAD,0xAC,0xDE,0x2C,
    0x1E,0x4C,0x30,0x95,0x64,0xE0,0x85,0x8D,0x6C,0xF4,0x9F,0xEF,0x30,0xA5,0x4E,0x6D,
    0x91,0x37,0x04,0xC5,0x3B,0xC6,0xA5,0x75,0xED,0x30,0xE8,0xBB,0xA0,0xCD,0x8B,0x49,
    0xAF,0xBC,0x80,0x67,0x34,0x55,0x2C,0x27,0xDC,0x0D,0xDC,0x7C,0x83,0xCE,0xEF,0x70,
    0x2C,0x4D,0xB4,0x45,0x88,0xC2,0xA3,0xC3,0xCA,0xE0,0xB4,0x25,0xC6,0xC9,0xB1,0xBF,
    0x68,0x90,0xFB,0xBD,0x96,0x17,0xCE,0x1B,0xBC,0xF7,0xB4,0x38,0x70,0xFC,0x7B,0xFE,
    0xB9,0x4B,0xF8,0xDB,0x72,0x7A,0x3B,0x74,0x8F,0x88,0xAE,0x33,0x14,0xD1,0x70,0x69,
    0xC7,0x2C,0x26,0xB1,0x63,0x1D,0xD5,0xA0,0x3E,0xB8,0x31,0x0D,0x02,0x18,0xB1,0xF8,
    0x70,0x81,0x20,0x3E,0x7A,0x95,0x23,0x66,0xFA,0x15,0xC4,0x26,0xC1,0x39,0x6A,0xAD,
#else // RSA_KEY_LENGTH_IN_BIT == RSA_KEY_LENGTH_3072BIT
    0xA4,0x91,0x6E,0x1E,0xD0,0x7E,0xDD,0x32,0x7D,0xE5,0x2B,0xBF,0x1E,0x6C,0xCD,0x15,
    0xAD,0x18,0x50,0xB7,0xC3,0xE2,0x80,0xC2,0x88,0xC7,0x07,0xDB,0x31,0xAD,0x78,0x9F,
    0xA9,0x2C,0x47,0x53,0xA3,0x69,0x3D,0xA3,0xA6,0x9A,0x39,0x43,0x90,0xD4,0x17,0x41,
    0xF0,0x5B,0xC2,0xD4,0x75,0xFE,0x9D,0xBB,0xA8,0x26,0xF0,0x14,0x3C,0x5C,0x38,0xA1,
    0x3E,0xE5,0x26,0x40,0xC7,0x76,0xD5,0x4A,0x23,0x79,0xFE,0x91,0x26,0x49,0x36,0x39,
    0x8F,0x7F,0xDA,0x48,0x70,0xF7,0x00,0xE9,0xD9,0xB9,0x27,0x7A,0x76,0x93,0x2D,0xB3,
    0x84,0x56,0xB8,0x65,0xBB,0xB5,0x27,0x06,0x23,0x0D,0x10,0x22,0xD1,0xDF,0xFD,0x0D,
    0xE1,0xC7,0xAF,0x96,0x7F,0x62,0x5C,0x61,0xB6,0x63,0x2B,0x46,0x30,0x6C,0x5B,0x22,
    0x58,0x66,0x69,0x3E,0x8E,0x27,0x07,0x2B,0x5C,0xC0,0xA2,0xE9,0xAB,0xA7,0x84,0x20,
    0x8F,0x28,0xD7,0x50,0x84,0x45,0xC9,0xBD,0x19,0xDC,0xDF,0x33,0xD9,0x22,0xF0,0xB4,
    0x42,0xDC,0x3C,0x63,0x5A,0xC8,0xF1,0x9E,0x98,0x13,0x34,0x1F,0xE1,0x5A,0x1D,0x00,
    0xA1,0xCE,0x35,0xD2,0x0E,0x6B,0xB3,0xF7,0x1B,0xE3,0xB5,0x74,0x5B,0xB5,0xFA,0x98,
    0x38,0xDF,0xCC,0x48,0x46,0xE2,0xE0,0x71,0x25,0x7F,0x90,0x28,0x2E,0x32,0x17,0xB7,
    0xC8,0xED,0xA5,0x62,0x46,0x11,0x6C,0x7E,0xE7,0x95,0x78,0xB0,0xE3,0xE6,0xC1,0x90,
    0xCD,0x29,0x94,0x88,0x3E,0xB2,0xC2,0x8B,0x78,0xF2,0x6B,0x38,0x52,0xB2,0x63,0x41,
    0x9E,0xCE,0x2F,0x87,0x8F,0x5F,0xFA,0x17,0xF6,0x62,0x62,0x97,0x63,0x6D,0x76,0xD3,
    0x03,0x7F,0x9D,0xDB,0xA9,0x0E,0x7B,0xC1,0x97,0xD2,0xCD,0x81,0x25,0x30,0x87,0x52,
    0x5E,0x3D,0x09,0x8C,0x9B,0xC4,0xE3,0xF1,0x7A,0x56,0x9C,0x19,0x4B,0x7A,0x87,0x77,
    0x06,0x04,0xAD,0x29,0x48,0x0F,0xFB,0x66,0x6C,0x05,0x33,0xE2,0x27,0x65,0x65,0xB4,
    0xB0,0x8C,0x1A,0x8F,0xC7,0x5B,0x52,0xA5,0xBB,0x5D,0x82,0x96,0x65,0x81,0x5E,0x2E,
    0x99,0x38,0xF4,0x2B,0x93,0xE1,0x82,0x77,0x83,0xFC,0x0C,0x2D,0x83,0x5C,0x93,0x96,
    0xDF,0x67,0x4E,0xBC,0xE6,0x0E,0xCA,0x93,0x1E,0x87,0x83,0x1B,0xF5,0xC5,0x74,0xAB,
    0xAD,0x0A,0x07,0x91,0x21,0xB9,0x13,0x5D,0x80,0x91,0x04,0xE0,0x6B,0x46,0x49,0xEC,
    0x41,0x33,0x8F,0xE2,0x50,0xF6,0x7E,0x00,0x0C,0x47,0x74,0x1C,0x89,0x51,0x5A,0x3F,
#endif
};

uint8_t barretCoef[RSA_KEY_LENGTH_IN_BIT/8u + 1u];  /* Must be modulo length + 1 BITS */
uint8_t inverseModulo[RSA_KEY_LENGTH_IN_BIT/8u];    /* Must be same as modulo length */
uint8_t rBar[RSA_KEY_LENGTH_IN_BIT/8u];             /* Must be same as modulo length */

/***********************************************************************************************************************
 * RSA decryption
 ***********************************************************************************************************************/
void Run_RSA(void)
{
    cy_stc_crypto_context_rsa_t cryptoRsaContext;

    /* At first convert endianness big to little.
     * Input keys and message are treated as little endian integer by Cy_Crypto_Rsa_Proc/Cy_Crypto_Rsa_CalcCoefs.
     */
    Cy_Crypto_Rsa_InvertEndianness(cipherTxt, sizeof(cipherTxt));
    Cy_Crypto_Rsa_InvertEndianness(modulus, sizeof(modulus));
    Cy_Crypto_Rsa_InvertEndianness(privateExponent, sizeof(privateExponent));
    Cy_Crypto_Rsa_InvertEndianness(publicExponent, sizeof(publicExponent));
    Cy_Crypto_Rsa_InvertEndianness(plainTxt, sizeof(plainTxt) - 1); /* Without end of \0 */

    /* Decrypt with the private key */
    {
        cy_stc_crypto_rsa_pub_key_t pubKeyPtr = 
        {
            .moduloPtr          = &modulus,
            .moduloLength       = RSA_KEY_LENGTH_IN_BIT,
            .pubExpPtr          = &privateExponent,
            .pubExpLength       = RSA_KEY_LENGTH_IN_BIT,
            .barretCoefPtr      = NULL,     /* Can be NULL. All coefficients will be calculated in  Cy_Crypto_Rsa_Proc */
            .inverseModuloPtr   = NULL,     /* Same as above */
            .rBarPtr            = NULL,     /* Same as above */
        };

        Cy_Crypto_Rsa_Proc
        (
            &cryptoCtx,
            &cryptoRsaContext,
            &pubKeyPtr,
            &cipherTxt,
            RSA_KEY_LENGTH_IN_BIT / 8u,         /* Size in byte */
            &decryptedTxt
        );
        /* Wait for completion */
        Cy_Crypto_Sync(true, &cryptoCtx);

        /* Calculated result is little endian */
        /* Then to compare with reference value, convert endianness to big endian. */
        Cy_Crypto_Rsa_InvertEndianness(decryptedTxt, sizeof(decryptedTxt));

        /* Compare with reference value just for testing. */
        /* You can remove following ASSERT */
        CY_ASSERT(memcmp(&decryptedTxt, &decryptedTxt_ref, RSA_KEY_LENGTH_IN_BIT/8u) == 0);
        /* Then you can get the result from decryptedTxt */
    }

    /* Encrypt with the public key */
    {
        cy_stc_crypto_rsa_pub_key_t pubKeyPtr = 
        {
            .moduloPtr          = &modulus,
            .moduloLength       = RSA_KEY_LENGTH_IN_BIT, /* The modulus length in bits */
            .pubExpPtr          = &publicExponent,
            .pubExpLength       = 17,       /* 17 bits */
            .barretCoefPtr      = NULL, /* Can be NULL. All coefficients will be calculated in  Cy_Crypto_Rsa_Proc */
            .inverseModuloPtr   = NULL, /* Same as above */
            .rBarPtr            = NULL, /* Same as above */
        };

        Cy_Crypto_Rsa_Proc
        (
            &cryptoCtx,
            &cryptoRsaContext,
            &pubKeyPtr,
            &plainTxt,
            RSA_KEY_LENGTH_IN_BIT / 8u,         /* Size in byte */
            &encryptedTxt
        );
        /* Wait for completion */
        Cy_Crypto_Sync(true, &cryptoCtx);

        /* Calculated result is little endian */
        /* Then to compare with reference value, convert endianness to big endian. */
        Cy_Crypto_Rsa_InvertEndianness(encryptedTxt, sizeof(encryptedTxt));

        /* Compare with reference value just for testing. */
        /* You can remove following ASSERT */
        CY_ASSERT(memcmp(&encryptedTxt, &encryptedTxt_ref, RSA_KEY_LENGTH_IN_BIT/8u) == 0);
        /* Then you can get the result from encryptedTxt */
    }

    /* Encrypt with the public key */
    /* You can calculate the accelerator coefficients by Cy_Crypto_Rsa_CalcCoefs */
    {
        cy_stc_crypto_rsa_pub_key_t pubKeyPtr = 
        {
            .moduloPtr          = &modulus,
            .moduloLength       = RSA_KEY_LENGTH_IN_BIT,
            .pubExpPtr          = &publicExponent,
            .pubExpLength       = 17,       /* 17 bits */
            .barretCoefPtr      = &barretCoef,
            .inverseModuloPtr   = &inverseModulo,
            .rBarPtr            = &rBar,
        };

        /* Calculate the coefficients previously */
        Cy_Crypto_Rsa_CalcCoefs
        (
            &cryptoCtx,
            &cryptoRsaContext,
            &pubKeyPtr
        );
        /* Wait for completion */
        Cy_Crypto_Sync(true, &cryptoCtx);

        /* Then encrypt the message */
        Cy_Crypto_Rsa_Proc
        (
            &cryptoCtx,
            &cryptoRsaContext,
            &pubKeyPtr,
            &plainTxt,
            RSA_KEY_LENGTH_IN_BIT / 8u,         /* Size in byte */
            &encryptedTxt
        );
        /* Wait for completion */
        Cy_Crypto_Sync(true, &cryptoCtx);

        /* Calculated result is little endian */
        /* Then to compare with reference value, convert endianness to big endian. */
        Cy_Crypto_Rsa_InvertEndianness(encryptedTxt, sizeof(encryptedTxt));

        /* Compare with reference value just for testing. */
        /* You can remove following ASSERT */
        CY_ASSERT(memcmp(&encryptedTxt, &encryptedTxt_ref, RSA_KEY_LENGTH_IN_BIT/8u) == 0);
        /* Then you can get the result from encryptedTxt */
    }
}

/***********************************************************************************************************************
 * main function
 ***********************************************************************************************************************/
int main(void)
{
    SystemInit();

    // Example had been originally tested with "cache off", so ensure that caches are turned off (may have been enabled by new startup.c module)
    SCB_DisableICache(); // Disables and invalidates instruction cache
    SCB_DisableDCache(); // Disables, cleans and invalidates data cache

    __enable_irq(); /* Enable global interrupts. */

    /* Initialize and enable CRYPTO */
    {
        cy_en_crypto_status_t status;
        do
        {
            status = Cy_Crypto_Init(&cryptoConfig, &cryptoCtx);
        } while(status != CY_CRYPTO_SUCCESS);
        Cy_Crypto_Enable(&cryptoCtx);
    }

    /* Run RSA */
    Run_RSA();

    for(;;)
    {
    }
}



/* [] END OF FILE */
